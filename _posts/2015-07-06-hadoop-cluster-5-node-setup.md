---
layout: post
title: "hadoop cluster 5 node setup"
description: ""
category: [hadoop]
tags: [ubuntu, ssh, static ip]
---
{% include JB/setup %}


### steps

1. install ubuntu 15.04 desktop on 5 nodes

2. setup ssh

### 1. setup ubuntu

1. download and install ubuntu desktop on 5 nodes

1. setup static ip address for 5 nodes

    1. node5

            $ sudo pico /etc/network/interfaces
            # interfaces(5) file used by ifup(8) and ifdown(8)
            auto lo
            iface lo inet loopback

            auto eth0
            iface eth0 inet static
            address 192.168.120.155
            netmask 255.255.255.0
            network 192.168.120.0
            broadcast 192.168.120.255
            gateway 192.168.120.1


            $ sudo pico /etc/resolv.conf 
            # Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
            #     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN

            nameserver 192.168.10.220
            nameserver 192.168.10.221


            $ sudo pico /etc/hosts
            127.0.0.1   localhost
            127.0.1.1   node5

            # The following lines are desirable for IPv6 capable hosts
            ::1     ip6-localhost ip6-loopback
            fe00::0 ip6-localnet
            ff00::0 ip6-mcastprefix
            ff02::1 ip6-allnodes
            ff02::2 ip6-allrouters

            192.168.120.155 node5
            192.168.120.154 node4
            192.168.120.153 node3
            192.168.120.152 node2
            192.168.120.152 node1


            $ ping www.baidu.com

    1. node1 node2 node3 node4

            # same as node5

1. change apt sources

            $ sudo sed 's@cn.archive.ubuntu.com@mirrors.163.com@' -i /etc/apt/sources.list
            $ sudo sed 's@security.ubuntu.com@mirrors.163.com@' -i /etc/apt/sources.list

1. set HADOOP_HOME JAVA_HOME

            $ sudo pico .bashrc

            ...
            export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64/jre
            export HADOOP_HOME=~/node5/hadoop
            export PATH=$PATH:$HADOOP_HOME
            export PATH=$PATH:$JAVA_HOME
            ...

            $ source .bashrc

### 2. setup ssh

1. install [openssh-server](http://www.openssh.com/)

    1. node1 to node5

            $ sudo apt-get install openssh-server

1. generate ssh key

    1. node5
            $ su - hduser
            $ ssh-keygen -t rsa -P "" 
            $ cd ~/.ssh
            $ cat id_rsa.pub >> authorized_keys

1. passwordless ssh login from node5

            $ ssh-copy-id -i id_rsa.pub node1@node1
            $ ssh-copy-id -i id_rsa.pub node2@node2
            $ ssh-copy-id -i id_rsa.pub node3@node3
            $ ssh-copy-id -i id_rsa.pub node4@node4

1. check ssh login

            $ ssh node1@node1
            ...
            exit

            $ ssh node2@node2
            ...
            exit

            $ ssh node3@node3
            ...
            exit

            $ ssh node4@node4
            ...
            exit

1. [remove key from known hosts](http://superuser.com/questions/30087/remove-key-from-known-hosts)

            $ rm -f .ssh/known_hosts

            or

            $ ssh-keygen -R "node1"